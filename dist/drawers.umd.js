(function(m,y){typeof exports=="object"&&typeof module<"u"?y(exports):typeof define=="function"&&define.amd?define(["exports"],y):(m=typeof globalThis<"u"?globalThis:m||self,y(m.Drawers={}))})(this,function(m){"use strict";var le=(m,y,C)=>{if(!y.has(m))throw TypeError("Cannot "+C)};var n=(m,y,C)=>(le(m,y,"read from private field"),C?C.call(m):y.get(m)),b=(m,y,C)=>{if(y.has(m))throw TypeError("Cannot add the same private member more than once");y instanceof WeakSet?y.add(m):y.set(m,C)},O=(m,y,C,Y)=>(le(m,y,"write to private field"),Y?Y.call(m,C):y.set(m,C),C);var _,E,z,K,f,F,x,X,U,T,P,L,S,N,j,q,R;function y(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var C={exports:{}};(function(s){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function r(h,o,l){this.fn=h,this.context=o,this.once=l||!1}function d(h,o,l,c,A){if(typeof l!="function")throw new TypeError("The listener must be a function");var v=new r(l,c||h,A),w=e?e+o:o;return h._events[w]?h._events[w].fn?h._events[w]=[h._events[w],v]:h._events[w].push(v):(h._events[w]=v,h._eventsCount++),h}function p(h,o){--h._eventsCount===0?h._events=new i:delete h._events[o]}function u(){this._events=new i,this._eventsCount=0}u.prototype.eventNames=function(){var o=[],l,c;if(this._eventsCount===0)return o;for(c in l=this._events)t.call(l,c)&&o.push(e?c.slice(1):c);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(l)):o},u.prototype.listeners=function(o){var l=e?e+o:o,c=this._events[l];if(!c)return[];if(c.fn)return[c.fn];for(var A=0,v=c.length,w=new Array(v);A<v;A++)w[A]=c[A].fn;return w},u.prototype.listenerCount=function(o){var l=e?e+o:o,c=this._events[l];return c?c.fn?1:c.length:0},u.prototype.emit=function(o,l,c,A,v,w){var k=e?e+o:o;if(!this._events[k])return!1;var a=this._events[k],M=arguments.length,D,g;if(a.fn){switch(a.once&&this.removeListener(o,a.fn,void 0,!0),M){case 1:return a.fn.call(a.context),!0;case 2:return a.fn.call(a.context,l),!0;case 3:return a.fn.call(a.context,l,c),!0;case 4:return a.fn.call(a.context,l,c,A),!0;case 5:return a.fn.call(a.context,l,c,A,v),!0;case 6:return a.fn.call(a.context,l,c,A,v,w),!0}for(g=1,D=new Array(M-1);g<M;g++)D[g-1]=arguments[g];a.fn.apply(a.context,D)}else{var ke=a.length,V;for(g=0;g<ke;g++)switch(a[g].once&&this.removeListener(o,a[g].fn,void 0,!0),M){case 1:a[g].fn.call(a[g].context);break;case 2:a[g].fn.call(a[g].context,l);break;case 3:a[g].fn.call(a[g].context,l,c);break;case 4:a[g].fn.call(a[g].context,l,c,A);break;default:if(!D)for(V=1,D=new Array(M-1);V<M;V++)D[V-1]=arguments[V];a[g].fn.apply(a[g].context,D)}}return!0},u.prototype.on=function(o,l,c){return d(this,o,l,c,!1)},u.prototype.once=function(o,l,c){return d(this,o,l,c,!0)},u.prototype.removeListener=function(o,l,c,A){var v=e?e+o:o;if(!this._events[v])return this;if(!l)return p(this,v),this;var w=this._events[v];if(w.fn)w.fn===l&&(!A||w.once)&&(!c||w.context===c)&&p(this,v);else{for(var k=0,a=[],M=w.length;k<M;k++)(w[k].fn!==l||A&&!w[k].once||c&&w[k].context!==c)&&a.push(w[k]);a.length?this._events[v]=a.length===1?a[0]:a:p(this,v)}return this},u.prototype.removeAllListeners=function(o){var l;return o?(l=e?e+o:o,this._events[l]&&p(this,l)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=e,u.EventEmitter=u,s.exports=u})(C);var Y=C.exports;const ae=y(Y);var ce=function(t){return he(t)&&!ue(t)};function he(s){return!!s&&typeof s=="object"}function ue(s){var t=Object.prototype.toString.call(s);return t==="[object RegExp]"||t==="[object Date]"||pe(s)}var fe=typeof Symbol=="function"&&Symbol.for,de=fe?Symbol.for("react.element"):60103;function pe(s){return s.$$typeof===de}function me(s){return Array.isArray(s)?[]:{}}function B(s,t){return t.clone!==!1&&t.isMergeableObject(s)?I(me(s),s,t):s}function we(s,t,e){return s.concat(t).map(function(i){return B(i,e)})}function ge(s,t){if(!t.customMerge)return I;var e=t.customMerge(s);return typeof e=="function"?e:I}function ye(s){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(s).filter(function(t){return Object.propertyIsEnumerable.call(s,t)}):[]}function te(s){return Object.keys(s).concat(ye(s))}function ne(s,t){try{return t in s}catch{return!1}}function be(s,t){return ne(s,t)&&!(Object.hasOwnProperty.call(s,t)&&Object.propertyIsEnumerable.call(s,t))}function ve(s,t,e){var i={};return e.isMergeableObject(s)&&te(s).forEach(function(r){i[r]=B(s[r],e)}),te(t).forEach(function(r){be(s,r)||(ne(s,r)&&e.isMergeableObject(t[r])?i[r]=ge(r,e)(s[r],t[r],e):i[r]=B(t[r],e))}),i}function I(s,t,e){e=e||{},e.arrayMerge=e.arrayMerge||we,e.isMergeableObject=e.isMergeableObject||ce,e.cloneUnlessOtherwiseSpecified=B;var i=Array.isArray(t),r=Array.isArray(s),d=i===r;return d?i?e.arrayMerge(s,t,e):ve(s,t,e):B(t,e)}I.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(i,r){return I(i,r,e)},{})};var Oe=I,Ee=Oe;const Ae=y(Ee);/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function se(s){return Object.prototype.toString.call(s)==="[object Object]"}function Ce(s){var t,e;return se(s)===!1?!1:(t=s.constructor,t===void 0?!0:(e=t.prototype,!(se(e)===!1||e.hasOwnProperty("isPrototypeOf")===!1)))}function Z(s){return s instanceof Element?s:document.querySelector(s)}async function ee(s){return await new Promise(t=>setTimeout(t,s))}const _e='[data-elem="drawer.panel"]',J="data-drawers-group",Le=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],re={modal:!0,focusOnChild:!0,closeOnEsc:!0,closeOnOutsideClick:!0,closeOnUnderlayClick:!0,onCloseConfirm:()=>!0,onBeforeClose:null,onClose:null,onCloseAnimationEnd:null,onBeforeOpen:null,onOpen:null,onOpenAnimationEnd:null,openClass:"drawer_open",closingClass:"drawer_closing",openingClass:"drawer_opening",openAnimationDuration:0,closeAnimationDuration:0,lockPageScroll:!0};function ie(s){return Ae.all(s,{isMergeableObject:Ce})}class Q{constructor({target:t,type:e,owner:i}){b(this,_,void 0);b(this,E,void 0);b(this,z,void 0);b(this,K,!1);const r=Z(t);if(!r)throw new Error("Trigger element cannot be found");O(this,_,r),O(this,E,i),O(this,z,e),this.init()}get isActive(){return n(this,K)}get owner(){return n(this,E)}init(){n(this,_).addEventListener("click",t=>this.clickHandler(t)),n(this,E).on("open",()=>this.setActive(!0)),n(this,E).on("close",()=>this.setActive(!1))}clickHandler(t){t.__drawerTrigger=this,n(this,z)==="open"?n(this,E).isOpen||n(this,E).open(n(this,_)):n(this,z)==="close"?n(this,E).isOpen&&n(this,E).close(n(this,_)):n(this,E).isOpen?n(this,E).close(n(this,_)):n(this,E).open(n(this,_))}setActive(t){O(this,K,t),t?n(this,_).classList.add("drawer-trigger_active"):n(this,_).classList.remove("drawer-trigger_active")}}_=new WeakMap,E=new WeakMap,z=new WeakMap,K=new WeakMap;class oe extends ae{constructor({target:e,options:i}){super();b(this,f,void 0);b(this,F,void 0);b(this,x,void 0);b(this,X,void 0);b(this,U,void 0);this.handleDocumentClick=async u=>{var l;if(((l=u.__drawerTrigger)==null?void 0:l.owner)===this)return;const h=u.target;if(u.composedPath(),this.dom.panel.contains(h))return;const o=h==null?void 0:h.closest("[data-drawer]");o?o.getAttribute("data-drawer")===n(this,U)?this.handleUnderlayClick(u):this.handleOtherDrawerClick(u):this.handleOutsideClick(u)},this.handleKeydown=u=>{n(this,f).closeOnEsc&&u.key==="Escape"&&this.close()};const r=ie(i?[re,i]:[re]),d=Z(e);if(d===null)throw new Error("Drawer's root cannot be found");O(this,U,d.getAttribute("data-drawer"));const p=d.querySelector(_e);if(p===null)throw new Error(`Drawer's panel cannot be found. Alias: ${n(this,U)}`);this.dom={root:d,panel:p},this.setOptions(r),this.dom.panel.setAttribute("tabindex","-1"),this.dom.root.classList.add("drawer_initialized")}addEventListeners(){this.dom.root.addEventListener("keydown",this.handleKeydown),document.addEventListener("click",this.handleDocumentClick)}removeEventListeners(){this.dom.root.removeEventListener("keydown",this.handleKeydown),document.removeEventListener("click",this.handleDocumentClick)}get isOpen(){return n(this,x)}get isModal(){return n(this,f).modal}set isModal(e){this.dom.root.classList[e?"add":"remove"]("drawer_modal")}get willLockScroll(){return n(this,f).lockPageScroll}set zIndex(e){this.dom.root.style.setProperty("--z-index",String(e)),O(this,F,e)}get zIndex(){return n(this,F)}async open(e){await ee(0),!n(this,x)&&(this.emit("beforeOpen",{drawer:this,trigger:e}),O(this,x,!0),this.dom.root.classList.add(n(this,f).openingClass),this.emit("open",{drawer:this,trigger:e}),typeof n(this,f).openAnimationDuration=="number"&&await ee(n(this,f).openAnimationDuration),this.dom.root.classList.remove(n(this,f).openingClass),this.dom.root.classList.add(n(this,f).openClass),this.emit("openAnimationEnd",{drawer:this,trigger:e}),this.focus(),this.addEventListeners())}async close(e){n(this,f).onCloseConfirm&&!n(this,f).onCloseConfirm(this,e)||(this.emit("beforeClose",{drawer:this,trigger:e}),this.removeEventListeners(),O(this,x,!1),this.dom.root.classList.remove(n(this,f).openClass),this.dom.root.classList.add(n(this,f).closingClass),this.emit("close",{drawer:this,trigger:e}),typeof n(this,f).closeAnimationDuration=="number"&&await ee(n(this,f).closeAnimationDuration),this.dom.root.classList.remove(n(this,f).closingClass),this.emit("closeAnimationEnd",{drawer:this,trigger:e}))}handleOtherDrawerClick(e){}handleOutsideClick(e){n(this,f).closeOnOutsideClick&&(typeof n(this,f).closeOnOutsideClick=="object"&&n(this,f).closeOnOutsideClick.hasOwnProperty("checkTarget")?n(this,f).closeOnOutsideClick.checkTarget(e.target)&&this.close():this.close())}handleUnderlayClick(e){n(this,f).closeOnOutsideClick&&this.close()}focus(){n(this,f).focusOnChild&&this.focusChild()||this.focusSelf()}focusSelf(){this.dom.panel.focus()}focusChild(){const e=this.dom.panel.querySelector(Le.join(","));return e?(e.focus(),!0):!1}setOptions(e){var i;e.hasOwnProperty("modal")&&((i=n(this,f))==null?void 0:i.modal)!==e.modal&&(this.isModal=e.modal),O(this,f,n(this,f)?ie([n(this,f),e]):e)}assignGroup(e){O(this,X,e)}}f=new WeakMap,F=new WeakMap,x=new WeakMap,X=new WeakMap,U=new WeakMap;class Se{constructor(){b(this,T,new Map)}lock(t,e){n(this,T).has(t)||n(this,T).set(t,new Set);const i=n(this,T).get(t);i.size===0&&t.classList.add("scroll-lock-by-drawer"),i.add(e)}unlock(t,e){const i=n(this,T).get(t);i==null||i.delete(e),(!i||i.size===0)&&t.classList.remove("scroll-lock-by-drawer")}}T=new WeakMap;const G=class G{constructor(t){b(this,P,void 0);b(this,L,void 0);b(this,S,void 0);b(this,N,void 0);b(this,j,void 0);O(this,L,[]),O(this,S,[]),O(this,j,new Map),this.onBeforeOpen=({drawer:r,trigger:d})=>{r.isModal?(n(this,j).set(r,n(this,L).length),n(this,L).push(r),r.zIndex=n(this,S).length+n(this,L).length):(n(this,j).set(r,n(this,S).length),n(this,S).push(r),r.zIndex=n(this,S).length,n(this,L).length>0&&n(this,L).forEach((p,u)=>p.zIndex=n(this,S).length+u+1)),r.willLockScroll&&this.lockScroll(r)},this.onCloseAnimationEnd=({drawer:r,trigger:d})=>{const p=r.isModal?n(this,L):n(this,S);for(delete p[n(this,j).get(r)];p.length&&!p.at(-1);)p.pop();n(this,j).delete(r),this.unlockScroll(r)};const e=Z(t);if(e===null)throw new Error("Drawer's group root cannot be found");O(this,P,e);const i=n(this,P).closest("[data-scrollable], html")||n(this,P).matches("[data-scrollable], html")&&n(this,P);if(i===null)throw new Error("Scrollable container for group root cannot be found");O(this,N,i)}add(t){t.on("beforeOpen",this.onBeforeOpen),t.on("closeAnimationEnd",this.onCloseAnimationEnd),t.assignGroup(this)}lockScroll(t){G.scrollLock.lock(n(this,N),t)}unlockScroll(t){G.scrollLock.unlock(n(this,N),t)}};P=new WeakMap,L=new WeakMap,S=new WeakMap,N=new WeakMap,j=new WeakMap,G.scrollLock=new Se;let $=G;const H=class H{constructor(){b(this,q,new Map);b(this,R,new Map);if(H.instance)return H.instance;H.instance=this}init(t){document.querySelectorAll(`[${J}]`).forEach(d=>{const p=d.getAttribute(J);typeof p=="string"&&n(this,R).set(p,new $(d))}),n(this,R).set("default",new $(document.documentElement)),document.querySelectorAll("[data-drawer]").forEach(d=>{var l;const p=d.getAttribute("data-drawer");if(typeof p!="string")return;const u=new oe({target:d,options:t});n(this,q).set(p,u);const h=d.closest(`[${J}]`),o=h?h.getAttribute(J):"default";if(typeof o!="string")throw new Error("Group doesn't have alias set correctly");(l=n(this,R).get(o))==null||l.add(u)}),document.querySelectorAll("[data-drawer-open], [data-drawer-close], [data-drawer-toggle]").forEach(d=>{if(d.hasAttribute("data-drawer-open")){const p=d.getAttribute("data-drawer-open");new Q({target:d,type:"open",owner:this.get(p)})}else if(d.hasAttribute("data-drawer-close")){const p=d.getAttribute("data-drawer-close");new Q({target:d,type:"close",owner:this.get(p)})}else{const p=d.getAttribute("data-drawer-toggle");new Q({target:d,type:"toggle",owner:this.get(p)})}})}open(t,{trigger:e,options:i}={}){var r;(r=this.get(t))==null||r.open(e)}close(t,{trigger:e,options:i}={}){var r;(r=this.get(t))==null||r.close(e)}get(t){return typeof t=="string"&&n(this,q).get(t)||null}on(t,e,i){var r;if(t)(r=this.get(t))==null||r.on(e,i);else for(const[d,p]of n(this,q))p.on(e,i)}};q=new WeakMap,R=new WeakMap;let W=H;typeof window<"u"&&(window.hasOwnProperty("app")||(window.app={}),window.app.drawers=new W),m.Drawer=oe,m.DrawersGroup=$,m.Trigger=Q,m.default=W,Object.defineProperties(m,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
