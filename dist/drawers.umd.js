(function(w,g){typeof exports=="object"&&typeof module<"u"?g(exports):typeof define=="function"&&define.amd?define(["exports"],g):(w=typeof globalThis<"u"?globalThis:w||self,g(w.Drawers={}))})(this,function(w){"use strict";var le=(w,g,C)=>{if(!g.has(w))throw TypeError("Cannot "+C)};var n=(w,g,C)=>(le(w,g,"read from private field"),C?C.call(w):g.get(w)),b=(w,g,C)=>{if(g.has(w))throw TypeError("Cannot add the same private member more than once");g instanceof WeakSet?g.add(w):g.set(w,C)},v=(w,g,C,Y)=>(le(w,g,"write to private field"),Y?Y.call(w,C):g.set(w,C),C);var _,E,z,K,p,F,x,X,U,T,P,S,k,N,j,q,R;function g(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var C={exports:{}};(function(r){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function s(u,o,l){this.fn=u,this.context=o,this.once=l||!1}function f(u,o,l,c,A){if(typeof l!="function")throw new TypeError("The listener must be a function");var O=new s(l,c||u,A),m=e?e+o:o;return u._events[m]?u._events[m].fn?u._events[m]=[u._events[m],O]:u._events[m].push(O):(u._events[m]=O,u._eventsCount++),u}function d(u,o){--u._eventsCount===0?u._events=new i:delete u._events[o]}function h(){this._events=new i,this._eventsCount=0}h.prototype.eventNames=function(){var o=[],l,c;if(this._eventsCount===0)return o;for(c in l=this._events)t.call(l,c)&&o.push(e?c.slice(1):c);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(l)):o},h.prototype.listeners=function(o){var l=e?e+o:o,c=this._events[l];if(!c)return[];if(c.fn)return[c.fn];for(var A=0,O=c.length,m=new Array(O);A<O;A++)m[A]=c[A].fn;return m},h.prototype.listenerCount=function(o){var l=e?e+o:o,c=this._events[l];return c?c.fn?1:c.length:0},h.prototype.emit=function(o,l,c,A,O,m){var L=e?e+o:o;if(!this._events[L])return!1;var a=this._events[L],M=arguments.length,D,y;if(a.fn){switch(a.once&&this.removeListener(o,a.fn,void 0,!0),M){case 1:return a.fn.call(a.context),!0;case 2:return a.fn.call(a.context,l),!0;case 3:return a.fn.call(a.context,l,c),!0;case 4:return a.fn.call(a.context,l,c,A),!0;case 5:return a.fn.call(a.context,l,c,A,O),!0;case 6:return a.fn.call(a.context,l,c,A,O,m),!0}for(y=1,D=new Array(M-1);y<M;y++)D[y-1]=arguments[y];a.fn.apply(a.context,D)}else{var Le=a.length,V;for(y=0;y<Le;y++)switch(a[y].once&&this.removeListener(o,a[y].fn,void 0,!0),M){case 1:a[y].fn.call(a[y].context);break;case 2:a[y].fn.call(a[y].context,l);break;case 3:a[y].fn.call(a[y].context,l,c);break;case 4:a[y].fn.call(a[y].context,l,c,A);break;default:if(!D)for(V=1,D=new Array(M-1);V<M;V++)D[V-1]=arguments[V];a[y].fn.apply(a[y].context,D)}}return!0},h.prototype.on=function(o,l,c){return f(this,o,l,c,!1)},h.prototype.once=function(o,l,c){return f(this,o,l,c,!0)},h.prototype.removeListener=function(o,l,c,A){var O=e?e+o:o;if(!this._events[O])return this;if(!l)return d(this,O),this;var m=this._events[O];if(m.fn)m.fn===l&&(!A||m.once)&&(!c||m.context===c)&&d(this,O);else{for(var L=0,a=[],M=m.length;L<M;L++)(m[L].fn!==l||A&&!m[L].once||c&&m[L].context!==c)&&a.push(m[L]);a.length?this._events[O]=a.length===1?a[0]:a:d(this,O)}return this},h.prototype.removeAllListeners=function(o){var l;return o?(l=e?e+o:o,this._events[l]&&d(this,l)):(this._events=new i,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=e,h.EventEmitter=h,r.exports=h})(C);var Y=C.exports;const ae=g(Y);var ce=function(t){return ue(t)&&!he(t)};function ue(r){return!!r&&typeof r=="object"}function he(r){var t=Object.prototype.toString.call(r);return t==="[object RegExp]"||t==="[object Date]"||pe(r)}var fe=typeof Symbol=="function"&&Symbol.for,de=fe?Symbol.for("react.element"):60103;function pe(r){return r.$$typeof===de}function we(r){return Array.isArray(r)?[]:{}}function B(r,t){return t.clone!==!1&&t.isMergeableObject(r)?I(we(r),r,t):r}function me(r,t,e){return r.concat(t).map(function(i){return B(i,e)})}function ye(r,t){if(!t.customMerge)return I;var e=t.customMerge(r);return typeof e=="function"?e:I}function ge(r){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(r).filter(function(t){return Object.propertyIsEnumerable.call(r,t)}):[]}function te(r){return Object.keys(r).concat(ge(r))}function ne(r,t){try{return t in r}catch{return!1}}function be(r,t){return ne(r,t)&&!(Object.hasOwnProperty.call(r,t)&&Object.propertyIsEnumerable.call(r,t))}function Oe(r,t,e){var i={};return e.isMergeableObject(r)&&te(r).forEach(function(s){i[s]=B(r[s],e)}),te(t).forEach(function(s){be(r,s)||(ne(r,s)&&e.isMergeableObject(t[s])?i[s]=ye(s,e)(r[s],t[s],e):i[s]=B(t[s],e))}),i}function I(r,t,e){e=e||{},e.arrayMerge=e.arrayMerge||me,e.isMergeableObject=e.isMergeableObject||ce,e.cloneUnlessOtherwiseSpecified=B;var i=Array.isArray(t),s=Array.isArray(r),f=i===s;return f?i?e.arrayMerge(r,t,e):Oe(r,t,e):B(t,e)}I.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(i,s){return I(i,s,e)},{})};var ve=I,Ee=ve;const Ae=g(Ee);/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function re(r){return Object.prototype.toString.call(r)==="[object Object]"}function Ce(r){var t,e;return re(r)===!1?!1:(t=r.constructor,t===void 0?!0:(e=t.prototype,!(re(e)===!1||e.hasOwnProperty("isPrototypeOf")===!1)))}function Z(r){return r instanceof Element?r:document.querySelector(r)}async function ee(r){return await new Promise(t=>setTimeout(t,r))}const _e='[data-elem="drawer.panel"]',J="data-drawers-group",Se=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],se={modal:!0,focusOnChild:!0,closeOnEsc:!0,closeOnOutsideClick:!0,closeOnUnderlayClick:!0,onCloseConfirm:()=>!0,onBeforeClose:null,onClose:null,onCloseAnimationEnd:null,onBeforeOpen:null,onOpen:null,onOpenAnimationEnd:null,openClass:"drawer_open",openAnimationDuration:0,closeAnimationDuration:0,lockPageScroll:!0};function ie(r){return Ae.all(r,{isMergeableObject:Ce})}class Q{constructor({target:t,type:e,owner:i}){b(this,_,void 0);b(this,E,void 0);b(this,z,void 0);b(this,K,!1);const s=Z(t);if(!s)throw new Error("Trigger element cannot be found");v(this,_,s),v(this,E,i),v(this,z,e),this.init()}get isActive(){return n(this,K)}get owner(){return n(this,E)}init(){n(this,_).addEventListener("click",t=>this.clickHandler(t)),n(this,E).on("open",()=>this.setActive(!0)),n(this,E).on("close",()=>this.setActive(!1))}clickHandler(t){t.__drawerTrigger=this,n(this,z)==="open"?n(this,E).isOpen||n(this,E).open(n(this,_)):n(this,z)==="close"?n(this,E).isOpen&&n(this,E).close(n(this,_)):n(this,E).isOpen?n(this,E).close(n(this,_)):n(this,E).open(n(this,_))}setActive(t){v(this,K,t),t?n(this,_).classList.add("drawer-trigger_active"):n(this,_).classList.remove("drawer-trigger_active")}}_=new WeakMap,E=new WeakMap,z=new WeakMap,K=new WeakMap;class oe extends ae{constructor({target:e,options:i}){super();b(this,p,void 0);b(this,F,void 0);b(this,x,void 0);b(this,X,void 0);b(this,U,void 0);this.handleDocumentClick=async h=>{var l;if(((l=h.__drawerTrigger)==null?void 0:l.owner)===this)return;const u=h.target;if(h.composedPath(),this.dom.panel.contains(u))return;const o=u==null?void 0:u.closest("[data-drawer]");o?o.getAttribute("data-drawer")===n(this,U)?this.handleUnderlayClick(h):this.handleOtherDrawerClick(h):this.handleOutsideClick(h)},this.handleKeydown=h=>{n(this,p).closeOnEsc&&h.key==="Escape"&&this.close()};const s=ie(i?[se,i]:[se]),f=Z(e);if(f===null)throw new Error("Drawer's root cannot be found");v(this,U,f.getAttribute("data-drawer"));const d=f.querySelector(_e);if(d===null)throw new Error(`Drawer's panel cannot be found. Alias: ${n(this,U)}`);this.dom={root:f,panel:d},this.setOptions(s),this.dom.panel.setAttribute("tabindex","-1"),this.dom.root.classList.add("drawer_initialized")}addEventListeners(){this.dom.root.addEventListener("keydown",this.handleKeydown),document.addEventListener("click",this.handleDocumentClick)}removeEventListeners(){this.dom.root.removeEventListener("keydown",this.handleKeydown),document.removeEventListener("click",this.handleDocumentClick)}get isOpen(){return n(this,x)}get isModal(){return n(this,p).modal}set isModal(e){this.dom.root.classList[e?"add":"remove"]("drawer_modal")}get willLockScroll(){return n(this,p).lockPageScroll}set zIndex(e){this.dom.root.style.setProperty("--z-index",String(e)),v(this,F,e)}get zIndex(){return n(this,F)}async open(e){await ee(0),!n(this,x)&&(this.emit("beforeOpen",{drawer:this,trigger:e}),v(this,x,!0),this.dom.root.classList.add(n(this,p).openClass),this.emit("open",{drawer:this,trigger:e}),typeof n(this,p).openAnimationDuration=="number"&&await ee(n(this,p).openAnimationDuration),this.emit("openAnimationEnd",{drawer:this,trigger:e}),this.focus(),this.addEventListeners())}async close(e){n(this,p).onCloseConfirm&&!n(this,p).onCloseConfirm(this,e)||(this.emit("beforeClose",{drawer:this,trigger:e}),this.removeEventListeners(),v(this,x,!1),this.dom.root.classList.remove(n(this,p).openClass),this.emit("close",{drawer:this,trigger:e}),typeof n(this,p).closeAnimationDuration=="number"&&await ee(n(this,p).closeAnimationDuration),this.emit("closeAnimationEnd",{drawer:this,trigger:e}))}handleOtherDrawerClick(e){}handleOutsideClick(e){n(this,p).closeOnOutsideClick&&(typeof n(this,p).closeOnOutsideClick=="object"&&n(this,p).closeOnOutsideClick.hasOwnProperty("checkTarget")?n(this,p).closeOnOutsideClick.checkTarget(e.target)&&this.close():this.close())}handleUnderlayClick(e){n(this,p).closeOnOutsideClick&&this.close()}focus(){n(this,p).focusOnChild&&this.focusChild()||this.focusSelf()}focusSelf(){this.dom.panel.focus()}focusChild(){const e=this.dom.panel.querySelector(Se.join(","));return e?(e.focus(),!0):!1}setOptions(e){var i;e.hasOwnProperty("modal")&&((i=n(this,p))==null?void 0:i.modal)!==e.modal&&(this.isModal=e.modal),v(this,p,n(this,p)?ie([n(this,p),e]):e)}assignGroup(e){v(this,X,e)}}p=new WeakMap,F=new WeakMap,x=new WeakMap,X=new WeakMap,U=new WeakMap;class ke{constructor(){b(this,T,new Map)}lock(t,e){n(this,T).has(t)||n(this,T).set(t,new Set);const i=n(this,T).get(t);i.size===0&&t.classList.add("scroll-lock-by-drawer"),i.add(e)}unlock(t,e){const i=n(this,T).get(t);i==null||i.delete(e),(!i||i.size===0)&&t.classList.remove("scroll-lock-by-drawer")}}T=new WeakMap;const G=class G{constructor(t){b(this,P,void 0);b(this,S,void 0);b(this,k,void 0);b(this,N,void 0);b(this,j,void 0);v(this,S,[]),v(this,k,[]),v(this,j,new Map),this.onBeforeOpen=({drawer:s,trigger:f})=>{s.isModal?(n(this,j).set(s,n(this,S).length),n(this,S).push(s),s.zIndex=n(this,k).length+n(this,S).length):(n(this,j).set(s,n(this,k).length),n(this,k).push(s),s.zIndex=n(this,k).length,n(this,S).length>0&&n(this,S).forEach((d,h)=>d.zIndex=n(this,k).length+h+1)),s.willLockScroll&&this.lockScroll(s)},this.onCloseAnimationEnd=({drawer:s,trigger:f})=>{const d=s.isModal?n(this,S):n(this,k);for(delete d[n(this,j).get(s)];d.length&&!d.at(-1);)d.pop();n(this,j).delete(s),this.unlockScroll(s)};const e=Z(t);if(e===null)throw new Error("Drawer's group root cannot be found");v(this,P,e);const i=n(this,P).closest("[data-scrollable], html")||n(this,P).matches("[data-scrollable], html")&&n(this,P);if(i===null)throw new Error("Scrollable container for group root cannot be found");v(this,N,i)}add(t){t.on("beforeOpen",this.onBeforeOpen),t.on("closeAnimationEnd",this.onCloseAnimationEnd),t.assignGroup(this)}lockScroll(t){G.scrollLock.lock(n(this,N),t)}unlockScroll(t){G.scrollLock.unlock(n(this,N),t)}};P=new WeakMap,S=new WeakMap,k=new WeakMap,N=new WeakMap,j=new WeakMap,G.scrollLock=new ke;let $=G;const H=class H{constructor(){b(this,q,new Map);b(this,R,new Map);if(H.instance)return H.instance;H.instance=this}init(t){document.querySelectorAll(`[${J}]`).forEach(f=>{const d=f.getAttribute(J);typeof d=="string"&&n(this,R).set(d,new $(f))}),n(this,R).set("default",new $(document.documentElement)),document.querySelectorAll("[data-drawer]").forEach(f=>{var l;const d=f.getAttribute("data-drawer");if(typeof d!="string")return;const h=new oe({target:f,options:t});n(this,q).set(d,h);const u=f.closest(`[${J}]`),o=u?u.getAttribute(J):"default";if(typeof o!="string")throw new Error("Group doesn't have alias set correctly");(l=n(this,R).get(o))==null||l.add(h)}),document.querySelectorAll("[data-drawer-open], [data-drawer-close], [data-drawer-toggle]").forEach(f=>{if(f.hasAttribute("data-drawer-open")){const d=f.getAttribute("data-drawer-open");new Q({target:f,type:"open",owner:this.get(d)})}else if(f.hasAttribute("data-drawer-close")){const d=f.getAttribute("data-drawer-close");new Q({target:f,type:"close",owner:this.get(d)})}else{const d=f.getAttribute("data-drawer-toggle");new Q({target:f,type:"toggle",owner:this.get(d)})}})}open(t,{trigger:e,options:i}={}){var s;(s=this.get(t))==null||s.open(e)}close(t,{trigger:e,options:i}={}){var s;(s=this.get(t))==null||s.close(e)}get(t){return typeof t=="string"&&n(this,q).get(t)||null}on(t,e,i){var s;if(t)(s=this.get(t))==null||s.on(e,i);else for(const[f,d]of n(this,q))d.on(e,i)}};q=new WeakMap,R=new WeakMap;let W=H;typeof window<"u"&&(window.hasOwnProperty("app")||(window.app={}),window.app.drawers=new W),w.Drawer=oe,w.DrawersGroup=$,w.Trigger=Q,w.default=W,Object.defineProperties(w,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
